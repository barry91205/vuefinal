import{_ as T,i as m,a as $,m as S,r as h,o as y,c as g,b as t,d,w as C,F as U,j as E,t as v,f as k,l as x,v as w,n as b,e as f}from"./index-mR1j4WQ4.js";import{c as V}from"./cartStore-wZCDnHfa.js";var N={VITE_URL:"https://vue3-course-api.hexschool.io",VITE_PATH:"kun123",BASE_URL:"/vuefinal/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_URL:u,VITE_PATH:n}=N,A={data(){return{cart:{},product:{},orderId:"",form:{user:{name:"",email:"",tel:"",address:""},message:""}}},methods:{getCarts(){m.get(`${u}/v2/api/${n}/cart`).then(o=>{console.log(o),this.cart=o.data.data,this.totalPrice=o.data.data.total})},changeCartQty(o,e=1){const i={product_id:o.product_id,qty:o.qty};m.put(`${u}/v2/api/${n}/cart/${o.id}`,{data:i}).then(r=>{console.log(r),this.getCarts()})},updateCart(o){const e=`${n}/v2/api/${n}/cart/${o.id}`,i={product_id:o.product_id,qty:o.qty};m.put(e,{data:i}).then(r=>{alert(r.data.message),this.getCart()}).catch(r=>{alert(r.response.data.message)})},removeCartItem(o){m.delete(`${u}/v2/api/${n}/cart/${o}`).then(e=>{alert(e.data.message),this.getCarts()})},deleteAllCarts(){const o=`${u}/v2/api/${n}/carts`;m.delete(o).then(e=>{alert(e.data.message),this.getCart()}).catch(e=>{alert(e.response.data.message)})},...$(V,["addToCart","getCart"]),createOrder(o){const e=`${u}/v2/api/${n}/order`,i=this.form;m.post(e,{data:i}).then(r=>{this.$Swal.fire({icon:"success",title:"訂單成立"}),this.$refs.form.resetForm(),this.orderId=r.data.orderId,this.$router.push(`/paycheck/${r.data.orderId}`),localStorage.setItem("orderId",r.data.orderId),this.getCarts()}).catch(()=>{this.$Swal.fire({icon:"error",title:"訂單失敗"})})}},computed:{...S(V,["carts","final_total"])},mounted(){this.getCarts()}},j={class:"bg-primary"},B={class:"container text-info"},D=k('<div class="row py-6"><div class="col-3 pt-6"><div class="border-bottom mb-2"><h2>訂單確認。</h2></div></div><div class="col-8"></div></div><div class="row text-center"><div class="col-4 step state rounded-start">填寫資料</div><div class="col-4 step">確認付款</div><div class="col-4 step rounded-end">完成訂單</div></div>',2),H={class:"row py-4"},R={class:"col-8"},L={class:"d-flex justify-content-between mb-4"},M=t("button",{type:"submit",class:"btn btn-info"},"繼續購買",-1),O={class:"row g-0"},P={class:"col-md-2"},F=["src"],Q={class:"cart col-md-10"},z={class:"row"},G={class:"col",style:{width:"200px"}},J={class:"col btn-group"},K=["onClick","disabled"],W=["onUpdate:modelValue","onChange","disabled"],X=["onClick"],Y={class:"col",style:{width:"200px"}},Z={class:"col"},tt=["onClick"],et=t("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",class:"bi bi-trash-fill",viewBox:"0 0 16 16"},[t("path",{d:"M2.5 1a1 1 0 0 0-1 1v1a1 1 0 0 0 1 1H3v9a2 2 0 0 0 2 2h6a2 2 0 0 0 2-2V4h.5a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1H10a1 1 0 0 0-1-1H7a1 1 0 0 0-1 1zm3 4a.5.5 0 0 1 .5.5v7a.5.5 0 0 1-1 0v-7a.5.5 0 0 1 .5-.5M8 5a.5.5 0 0 1 .5.5v7a.5.5 0 0 1-1 0v-7A.5.5 0 0 1 8 5m3 .5v7a.5.5 0 0 1-1 0v-7a.5.5 0 0 1 1 0"})],-1),st=[et],ot={class:"border bg-secondary p-4"},at=t("h2",null,"訂單明細",-1),lt=t("hr",null,null,-1),rt={class:"d-flex justify-content-between mb-4"},dt=t("h5",null,"小計",-1),nt=k('<div class="d-flex mb-4"><form class="input-group total-coupon-input"><input type="text" placeholder="輸入酷碰序號" class="form-control"><button type="submit" class="btn btn-primary">套用</button></form></div><div class="d-flex justify-content-between mb-4"><h5>酷碰券折抵</h5><span>NT$ 0</span></div>',2),it={class:"d-flex justify-content-between"},ct=t("h5",null,"共計",-1),mt={class:"col-4"},ut={class:"row justify-content-center border py-4"},_t={class:"mb-3"},pt=t("label",{for:"email",class:"form-label"},[f("Email"),t("span",{class:"marker"},"*")],-1),ht={class:"mb-3"},vt=t("label",{for:"name",class:"form-label"},[f("收件人姓名"),t("span",{class:"marker"},"*")],-1),bt={class:"mb-3"},ft=t("label",{for:"tel",class:"form-label"},[f("收件人電話"),t("span",{class:"marker"},"*")],-1),yt={class:"mb-3"},gt=t("label",{for:"address",class:"form-label"},[f("收件人地址"),t("span",{class:"marker"},"*")],-1),Ct={class:"mb-3"},xt=t("label",{for:"message",class:"form-label"},"留言",-1),wt=t("div",{class:"text-end"},[t("button",{type:"submit",class:"btn btn-secondary"},"送出訂單")],-1);function Vt(o,e,i,r,l,c){const q=h("router-link"),_=h("v-field"),p=h("error-message"),I=h("v-form");return y(),g("div",j,[t("div",B,[D,t("div",H,[t("div",R,[t("div",L,[d(q,{to:"/products"},{default:C(()=>[M]),_:1}),t("button",{type:"submit",class:"btn btn-outline-info",onClick:e[0]||(e[0]=(...s)=>c.deleteAllCarts&&c.deleteAllCarts(...s))},"清空購物車")]),(y(!0),g(U,null,E(l.cart.carts,s=>(y(),g("div",{class:"border mb-3 bg-info text-primary",style:{"max-width":"850px"},key:s.id},[t("div",O,[t("div",P,[t("img",{src:s.product.imageUrl,class:"img-fluid rounded-start",alt:"...",width:"150"},null,8,F)]),t("div",Q,[t("div",z,[t("div",G,[t("h5",null,v(s.product.title),1)]),t("div",J,[t("button",{type:"button",class:"btn btn-secondary",onClick:a=>{s.qty--,c.changeCartQty(s,s.qty)},disabled:s.qty===1},"-",8,K),x(t("input",{min:"1",type:"number",class:"productNumber","onUpdate:modelValue":a=>s.qty=a,onChange:a=>c.changeCartQty(s,s.qty),disabled:s.qty===1,readonly:""},null,40,W),[[w,s.qty,void 0,{number:!0}]]),t("button",{type:"button",class:"btn btn-secondary",onClick:a=>s.qty++},"+",8,X)]),t("div",Y,[t("h5",null,"NT$"+v(s.product.price),1)]),t("div",Z,[t("button",{type:"button",class:"btn btn-outline-danger",onClick:a=>c.removeCartItem(s.id)},st,8,tt)])])])])]))),128)),t("div",ot,[at,lt,t("div",rt,[dt,t("span",null,"NT$ "+v(l.cart.final_total),1)]),nt,t("div",it,[ct,t("span",null,"NT$ "+v(l.cart.final_total),1)])])]),t("div",mt,[t("div",ut,[d(I,{ref:"form",onSubmit:c.createOrder},{default:C(({errors:s})=>[t("div",_t,[pt,d(_,{id:"email",name:"email",type:"email",class:b(["form-control",{"is-invalid":s.email}]),placeholder:"請輸入 Email",rules:"email|required",modelValue:l.form.user.email,"onUpdate:modelValue":e[1]||(e[1]=a=>l.form.user.email=a)},null,8,["class","modelValue"]),d(p,{name:"email",class:"invalid-feedback"})]),t("div",ht,[vt,d(_,{id:"name",name:"姓名",type:"text",class:b(["form-control",{"is-invalid":s.姓名}]),placeholder:"請輸入姓名",rules:"required","aria-required":"true",modelValue:l.form.user.name,"onUpdate:modelValue":e[2]||(e[2]=a=>l.form.user.name=a)},null,8,["class","modelValue"]),d(p,{name:"姓名",class:"invalid-feedback"})]),t("div",bt,[ft,d(_,{id:"tel",name:"電話",type:"text",class:b(["form-control",{"is-invalid":s.電話}]),placeholder:"請輸入電話",rules:"required|min:8|max:10",modelValue:l.form.user.tel,"onUpdate:modelValue":e[3]||(e[3]=a=>l.form.user.tel=a)},null,8,["class","modelValue"]),d(p,{name:"電話",class:"invalid-feedback"})]),t("div",yt,[gt,d(_,{id:"address",name:"地址",type:"text",class:b(["form-control",{"is-invalid":s.地址}]),placeholder:"請輸入地址",rules:"required",modelValue:l.form.user.address,"onUpdate:modelValue":e[4]||(e[4]=a=>l.form.user.address=a)},null,8,["class","modelValue"]),d(p,{name:"地址",class:"invalid-feedback"})]),t("div",Ct,[xt,x(t("textarea",{name:"",id:"message",class:"form-control",cols:"30",rows:"10","onUpdate:modelValue":e[5]||(e[5]=a=>l.form.message=a)},null,512),[[w,l.form.message]])]),wt]),_:1},8,["onSubmit"])])])])])])}const It=T(A,[["render",Vt]]);export{It as default};

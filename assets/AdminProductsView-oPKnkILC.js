import{_ as b,L as w,i,r as p,o as a,c,b as t,d as _,w as m,u as $,x as k,F as v,j as y,t as l}from"./index-mR1j4WQ4.js";var P={VITE_URL:"https://vue3-course-api.hexschool.io",VITE_PATH:"kun123",BASE_URL:"/vuefinal/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_URL:d,VITE_PATH:r}=P,x={data(){return{products:[],pages:{},isNew:!1,tempProduct:{imagesUrl:[]},pagination:{},isLoading:!0}},components:{Loading:w},methods:{checkAdmin(){const e=`${d}/v2/api/user/check`;i.post(e).then(s=>{this.getData()}).catch(s=>{console.log(s),window.location="LoginView.vue"})},getData(e=1){this.isLoading=!0;const s=`${d}/v2/api/${r}/admin/products?page=${e}`;i.get(s).then(o=>{console.log(o),this.products=o.data.products,this.allProducts=o.data.products,this.isLoading=!1}).catch(()=>{})},updateProduct(){let e=`${d}/v2/api/${r}/admin/product`,s="post";this.isNew||(e=`${d}/api/${r}/v2/admin/product/${this.tempProduct.id}`,s="put"),i[s](e,{data:this.tempProduct}).then(o=>{alert(o.data.message),this.$refs.pModal.closeModal(),this.getData(),this.tempProduct={}}).catch(o=>{alert(o.response.data.message)})},delProduct(e){const s=`${d}/v2/api/${r}/admin/product/${e}`;console.log(this.tempProduct),i.delete(s).then(o=>{this.$Swal.fire({title:"確定刪除商品?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#eb5a68",cancelButtonColor:"#8bafd7",confirmButtonText:"確定刪除",cancelButtonText:"取消"}),this.$Swal.fire({position:"top-end",title:"已刪除",icon:"success",showConfirmButton:!1,timer:1e3}),this.getData()}).catch(o=>{this.$Swal.fire({icon:"error",title:o.response.data.message})})}},mounted(){const e=document.cookie.replace(/(?:(?:^|.*;\s*)hexToken\s*=\s*([^;]*).*$)|^.*$/,"$1");i.defaults.headers.common.Authorization=e,this.checkAdmin(),this.getData()}},L={class:"container"},B={class:"d-flex justify-content-between py-4 py-md-5"},V=t("h2",{class:"fw-bold"},"商品管理",-1),C=t("button",{class:"btn btn-outline-primary"}," 建立新的產品 ",-1),D={class:"table mt-4"},T=t("thead",null,[t("tr",null,[t("th",{width:"120"}," 分類 "),t("th",null,"房型名稱"),t("th",{width:"120"}," 原價 "),t("th",{width:"120"}," 售價 "),t("th",{width:"100"}," 是否啟用 "),t("th",{width:"120"}," 編輯 ")])],-1),E={key:0,class:"text-success"},A={key:1},S={class:"btn-group"},N=t("button",{type:"button",class:"btn btn-outline-primary btn-sm"}," 編輯 ",-1),R=["onClick"];function I(e,s,o,U,u,g){const h=p("router-link"),f=p("loading");return a(),c("div",L,[t("div",B,[V,_(h,{to:"/admin/addproduct"},{default:m(()=>[C]),_:1})]),t("table",D,[T,t("tbody",null,[u.isLoading?(a(),$(f,{key:0,active:u.isLoading,"can-cancel":!1},null,8,["active"])):k("",!0),(a(!0),c(v,null,y(u.products,n=>(a(),c("tr",{key:n.id},[t("td",null,l(n.category),1),t("td",null,l(n.title),1),t("td",null,l(n.origin_price),1),t("td",null,l(n.price),1),t("td",null,[n.is_enabled?(a(),c("span",E,"啟用")):(a(),c("span",A,"未啟用"))]),t("td",null,[t("div",S,[_(h,{to:"product/edit/"+n.id},{default:m(()=>[N]),_:2},1032,["to"]),t("button",{type:"button",class:"btn btn-outline-danger btn-sm",onClick:M=>g.delProduct(n.id)}," 刪除 ",8,R)])])]))),128))])])])}const F=b(x,[["render",I]]);export{F as default};

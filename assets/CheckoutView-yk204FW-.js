import{_ as $,h as m,a as S,m as U,r as f,o as u,c as _,b as t,e as p,d as r,w as C,n as V,F as E,i as N,t as y,f as I,q as k,v as w,s as g}from"./index-YcKa0FCS.js";import{c as q}from"./cartStore--2hBoBHU.js";var A={VITE_URL:"https://vue3-course-api.hexschool.io",VITE_PATH:"kun123",BASE_URL:"/vuefinal/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_URL:h,VITE_PATH:d}=A,j={data(){return{cart:{},product:{},orderId:"",form:{user:{name:"",email:"",tel:"",address:""},message:""}}},methods:{getCarts(){m.get(`${h}/v2/api/${d}/cart`).then(o=>{console.log(o),this.cart=o.data.data,this.totalPrice=o.data.data.total})},changeCartQty(o,e=1){const c={product_id:o.product_id,qty:o.qty};m.put(`${h}/v2/api/${d}/cart/${o.id}`,{data:c}).then(n=>{console.log(n),this.getCarts()})},updateCart(o){const e=`${d}/v2/api/${d}/cart/${o.id}`,c={product_id:o.product_id,qty:o.qty};m.put(e,{data:c}).then(n=>{alert(n.data.message),this.getCart()}).catch(n=>{alert(n.response.data.message)})},removeCartItem(o){m.delete(`${h}/v2/api/${d}/cart/${o}`).then(e=>{alert(e.data.message),this.getCarts()})},deleteAllCarts(){const o=`${h}/v2/api/${d}/carts`;m.delete(o).then(e=>{alert(e.data.message),this.getCart()}).catch(e=>{alert(e.response.data.message)})},...S(q,["addToCart","getCart"]),createOrder(o){const e=`${h}/v2/api/${d}/order`,c=this.form;m.post(e,{data:c}).then(n=>{this.$Swal.fire({icon:"success",title:"訂單成立"}),this.$refs.form.resetForm(),this.orderId=n.data.orderId,this.$router.push(`/paycheck/${n.data.orderId}`),localStorage.setItem("orderId",n.data.orderId),this.getCarts()}).catch(()=>{this.$Swal.fire({icon:"error",title:"訂單失敗"})})}},computed:{...U(q,["carts","final_total"])},mounted(){this.getCarts()}},B={class:"bg-primary"},D={class:"container text-info"},H=I('<div class="row py-md-6"><div class="col-md-3 pt-6 col-sm-5"><div class="border-bottom mb-2"><h2>訂單確認。</h2></div></div><div class="col-8"></div></div><div class="row text-center"><div class="col-4 step state rounded-start">1.填寫資料</div><div class="col-4 step">2.確認付款</div><div class="col-4 step rounded-end">3.完成訂單</div></div>',2),R={class:"row py-4"},L={class:"col-md-8 col-sm-12"},M={key:0,class:"text-info d-flex align-items-center justify-content-center mb-2",style:{height:"200px","background-color":"rgba(99, 99, 99, 0.90)","z-index":"100"}},O=t("button",{type:"submit",class:"btn btn-info ms-2"},"去逛逛",-1),P={key:1,class:"d-flex justify-content-between mb-4"},z=t("button",{type:"submit",class:"btn btn-info"},"繼續購買",-1),F={class:"row"},Q={class:"col-md-2 col-sm-3"},G=["src"],J={class:"cart col-md-10 col-sm-9"},K={class:"row"},W={class:"col",style:{width:"200px"}},X={class:"col btn-group"},Y=["onClick","disabled"],Z=["onUpdate:modelValue","onChange","disabled"],tt=["onClick"],et={class:"col",style:{width:"200px"}},st={class:"col"},ot=["onClick"],at=t("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",class:"bi bi-trash-fill",viewBox:"0 0 16 16"},[t("path",{d:"M2.5 1a1 1 0 0 0-1 1v1a1 1 0 0 0 1 1H3v9a2 2 0 0 0 2 2h6a2 2 0 0 0 2-2V4h.5a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1H10a1 1 0 0 0-1-1H7a1 1 0 0 0-1 1zm3 4a.5.5 0 0 1 .5.5v7a.5.5 0 0 1-1 0v-7a.5.5 0 0 1 .5-.5M8 5a.5.5 0 0 1 .5.5v7a.5.5 0 0 1-1 0v-7A.5.5 0 0 1 8 5m3 .5v7a.5.5 0 0 1-1 0v-7a.5.5 0 0 1 1 0"})],-1),lt=[at],rt={class:"border bg-secondary p-4"},nt=t("h2",null,"訂單明細",-1),dt=t("hr",null,null,-1),ct={class:"d-flex justify-content-between mb-4"},it=t("h5",null,"小計",-1),mt=I('<div class="d-flex mb-4"><form class="input-group total-coupon-input"><input type="text" placeholder="輸入酷碰序號" class="form-control"><button type="submit" class="btn btn-primary">套用</button></form></div><div class="d-flex justify-content-between mb-4"><h5>酷碰券折抵</h5><span>NT$ 0</span></div>',2),ut={class:"d-flex justify-content-between"},_t=t("h5",null,"共計",-1),ht={class:"col-md-4 col-sm-12"},pt={class:"row justify-content-center border py-4"},vt={class:"mb-3"},bt=t("label",{for:"email",class:"form-label"},[p("Email"),t("span",{class:"marker"},"*")],-1),ft={class:"mb-3"},yt=t("label",{for:"name",class:"form-label"},[p("收件人姓名"),t("span",{class:"marker"},"*")],-1),gt={class:"mb-3"},Ct=t("label",{for:"tel",class:"form-label"},[p("收件人電話"),t("span",{class:"marker"},"*")],-1),xt={class:"mb-3"},Vt=t("label",{for:"address",class:"form-label"},[p("收件人地址"),t("span",{class:"marker"},"*")],-1),kt={class:"mb-3"},wt=t("label",{for:"message",class:"form-label"},"留言",-1),qt=t("div",{class:"text-end"},[t("button",{type:"submit",class:"btn btn-secondary"},"送出訂單")],-1);function It(o,e,c,n,l,i){const x=f("router-link"),v=f("v-field"),b=f("error-message"),T=f("v-form");return u(),_("div",B,[t("div",D,[H,t("div",R,[t("div",L,[o.carts.length===0?(u(),_("div",M,[p(" 購物車沒有任何商品 "),r(x,{to:"/products"},{default:C(()=>[O]),_:1})])):V("",!0),o.carts.length>0?(u(),_("div",P,[r(x,{to:"/products"},{default:C(()=>[z]),_:1}),t("button",{type:"submit",class:"btn btn-outline-info",onClick:e[0]||(e[0]=(...s)=>i.deleteAllCarts&&i.deleteAllCarts(...s))},"清空購物車")])):V("",!0),(u(!0),_(E,null,N(l.cart.carts,s=>(u(),_("div",{class:"border mb-3 bg-info text-primary",key:s.id},[t("div",F,[t("div",Q,[t("img",{src:s.product.imageUrl,class:"img-fluid"},null,8,G)]),t("div",J,[t("div",K,[t("div",W,[t("h5",null,y(s.product.title),1)]),t("div",X,[t("button",{type:"button",class:"btn btn-secondary",onClick:a=>{s.qty--,i.changeCartQty(s,s.qty)},disabled:s.qty===1},"-",8,Y),k(t("input",{min:"1",type:"number",class:"productNumber","onUpdate:modelValue":a=>s.qty=a,onChange:a=>i.changeCartQty(s,s.qty),disabled:s.qty===1,readonly:""},null,40,Z),[[w,s.qty,void 0,{number:!0}]]),t("button",{type:"button",class:"btn btn-secondary",onClick:a=>s.qty++},"+",8,tt)]),t("div",et,[t("h5",null,"NT$"+y(s.product.price),1)]),t("div",st,[t("button",{type:"button",class:"btn btn-outline-danger",onClick:a=>i.removeCartItem(s.id)},lt,8,ot)])])])])]))),128)),t("div",rt,[nt,dt,t("div",ct,[it,t("span",null,"NT$ "+y(l.cart.final_total),1)]),mt,t("div",ut,[_t,t("span",null,"NT$ "+y(l.cart.final_total),1)])])]),t("div",ht,[t("div",pt,[r(T,{ref:"form",onSubmit:i.createOrder},{default:C(({errors:s})=>[t("div",vt,[bt,r(v,{id:"email",name:"email",type:"email",class:g(["form-control",{"is-invalid":s.email}]),placeholder:"請輸入 Email",rules:"email|required",modelValue:l.form.user.email,"onUpdate:modelValue":e[1]||(e[1]=a=>l.form.user.email=a)},null,8,["class","modelValue"]),r(b,{name:"email",class:"invalid-feedback"})]),t("div",ft,[yt,r(v,{id:"name",name:"姓名",type:"text",class:g(["form-control",{"is-invalid":s.姓名}]),placeholder:"請輸入姓名",rules:"required","aria-required":"true",modelValue:l.form.user.name,"onUpdate:modelValue":e[2]||(e[2]=a=>l.form.user.name=a)},null,8,["class","modelValue"]),r(b,{name:"姓名",class:"invalid-feedback"})]),t("div",gt,[Ct,r(v,{id:"tel",name:"電話",type:"text",class:g(["form-control",{"is-invalid":s.電話}]),placeholder:"請輸入電話",rules:"required|min:8|max:10",modelValue:l.form.user.tel,"onUpdate:modelValue":e[3]||(e[3]=a=>l.form.user.tel=a)},null,8,["class","modelValue"]),r(b,{name:"電話",class:"invalid-feedback"})]),t("div",xt,[Vt,r(v,{id:"address",name:"地址",type:"text",class:g(["form-control",{"is-invalid":s.地址}]),placeholder:"請輸入地址",rules:"required",modelValue:l.form.user.address,"onUpdate:modelValue":e[4]||(e[4]=a=>l.form.user.address=a)},null,8,["class","modelValue"]),r(b,{name:"地址",class:"invalid-feedback"})]),t("div",kt,[wt,k(t("textarea",{name:"",id:"message",class:"form-control",cols:"30",rows:"10","onUpdate:modelValue":e[5]||(e[5]=a=>l.form.message=a)},null,512),[[w,l.form.message]])]),qt]),_:1},8,["onSubmit"])])])])])])}const St=$(j,[["render",It]]);export{St as default};

import{_ as P,L as v,h as i,r as h,o as c,c as l,b as t,d as r,w as m,F as f,i as k,t as u}from"./index-YcKa0FCS.js";import{P as $}from"./PaginationView-qUy6xC1b.js";var L={VITE_URL:"https://vue3-course-api.hexschool.io",VITE_PATH:"kun123",BASE_URL:"/vuefinal/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_URL:d,VITE_PATH:p}=L,y={data(){return{products:[],pages:{},isNew:!1,tempProduct:{imagesUrl:[]},pagination:{},isLoading:!0,loader:"bars"}},components:{Pagination:$,Loading:v},methods:{checkAdmin(){const e=`${d}/v2/api/user/check`;i.post(e).then(o=>{}).catch(o=>{console.log(o),window.location="LoginView.vue"})},getData(e=1){this.isLoading=!0;const o=`${d}/v2/api/${p}/admin/products?page=${e}`;i.get(o).then(n=>{console.log(n),this.products=n.data.products,this.pagination=n.data.pagination,this.isLoading=!1}).catch(()=>{})},updateProduct(){let e=`${d}/v2/api/${p}/admin/product`,o="post";this.isNew||(e=`${d}/api/${p}/v2/admin/product/${this.tempProduct.id}`,o="put"),i[o](e,{data:this.tempProduct}).then(n=>{alert(n.data.message),this.$refs.pModal.closeModal(),this.getData(),this.tempProduct={}}).catch(n=>{alert(n.response.data.message)})},delProduct(e){const o=`${d}/v2/api/${p}/admin/product/${e}`;console.log(this.tempProduct),i.delete(o).then(n=>{this.$Swal.fire({title:"確定刪除商品?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#7D6E4D",cancelButtonColor:"#C6BBA2",confirmButtonText:"確定刪除",cancelButtonText:"取消"}),this.getData()}).catch(n=>{this.$Swal.fire({icon:"error",title:n.response.data.message})})}},mounted(){const e=document.cookie.replace(/(?:(?:^|.*;\s*)hexToken\s*=\s*([^;]*).*$)|^.*$/,"$1");i.defaults.headers.common.Authorization=e,this.checkAdmin(),this.getData()}},B={class:"container"},D={class:"d-flex justify-content-between py-4 py-md-5"},E=t("h2",{class:"fw-bold"},"商品管理",-1),x=t("button",{class:"btn btn-outline-primary"}," 建立新的產品 ",-1),T={class:"table mt-4"},V=t("thead",null,[t("tr",null,[t("th",{width:"120"}," 分類 "),t("th",null,"房型名稱"),t("th",{width:"120"}," 原價 "),t("th",{width:"120"}," 售價 "),t("th",{width:"100"}," 是否啟用 "),t("th",{width:"120"}," 編輯 ")])],-1),A={key:0,class:"text-success"},C={key:1},S={class:"btn-group"},R=t("button",{type:"button",class:"btn btn-outline-primary btn-sm"}," 編輯 ",-1),U=["onClick"];function I(e,o,n,N,a,_){const g=h("router-link"),b=h("Loading"),w=h("Pagination");return c(),l(f,null,[t("div",B,[t("div",D,[E,r(g,{to:"/admin/addproduct"},{default:m(()=>[x]),_:1})]),t("table",T,[V,t("tbody",null,[r(b,{active:a.isLoading,"onUpdate:active":o[0]||(o[0]=s=>a.isLoading=s),"can-cancel":!1,"is-full-page":e.fullPage,loader:a.loader},null,8,["active","is-full-page","loader"]),(c(!0),l(f,null,k(a.products,s=>(c(),l("tr",{key:s.id},[t("td",null,u(s.category),1),t("td",null,u(s.title),1),t("td",null,u(s.origin_price),1),t("td",null,u(s.price),1),t("td",null,[s.is_enabled?(c(),l("span",A,"啟用")):(c(),l("span",C,"未啟用"))]),t("td",null,[t("div",S,[r(g,{to:"product/edit/"+s.id},{default:m(()=>[R]),_:2},1032,["to"]),t("button",{type:"button",class:"btn btn-outline-danger btn-sm",onClick:M=>_.delProduct(s.id)}," 刪除 ",8,U)])])]))),128))])])]),r(w,{pagination:a.pagination,onEmitPages:_.getData},null,8,["pagination","onEmitPages"])],64)}const O=P(y,[["render",I]]);export{O as default};
